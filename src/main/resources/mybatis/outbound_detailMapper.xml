<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.mapper.Outbound_detailMapper">
    <insert id="insert">
        <selectKey keyProperty="outbound_detail_id" resultType="int" order="BEFORE">
            SELECT outbound_detail_seq.NEXTVAL FROM dual
        </selectKey>
        insert into outbound_detail(
            outbound_detail_id,
            outbound_id,
            product_id,
            approval_status,
            outbound_status,
            quantity
        ) values(
            #{outbound_detail_id},
            #{outbound_id},
            #{product_id},
            'REQUEST',
            'REQUEST',
            #{quantity}
        )
    </insert>
    <insert id="insert_exp">
        <selectKey keyProperty="outbound_detail_id" resultType="int" order="BEFORE">
            SELECT outbound_detail_seq.NEXTVAL FROM dual
        </selectKey>
        insert into outbound_detail(
        outbound_detail_id,
        outbound_id,
        product_id,
        approval_status,
        outbound_status,
        quantity
        ) values(
        #{outbound_detail_id},
        #{outbound_id},
        #{product_id},
        'APPROVED',
        'REQUEST',
        #{quantity}
        )
    </insert>
    <update id="update_outStatus" parameterType="Outbound_detailDto">
        update outbound_detail set outbound_status=#{outbound_status} where outbound_detail_id=#{outbound_detail_id}
    </update>
    <update id="update_outStatus_rej" parameterType="int">
        update outbound_detail set outbound_status='REJECTED' where outbound_detail_id=#{outbound_detail_id}
    </update>
    <update id="update_outStatus_conf" parameterType="int">
        update outbound_detail set outbound_status='CONFIRMED' where outbound_detail_id=#{outbound_detail_id}
    </update>
    <update id="update_appStatus" parameterType="Outbound_detailDto">
        update outbound_detail set approval_status=#{approval_status} where outbound_detail_id=#{outbound_detail_id}
    </update>
    <update id="update_appStatus_rej" parameterType="int">
        update outbound_detail set approval_status='REJECTED' where outbound_detail_id=#{outbound_detail_id}
    </update>
    <update id="update_appStatus_conf" parameterType="int">
        update outbound_detail set approval_status='CONFIRMED' where outbound_detail_id=#{outbound_detail_id}
    </update>
</mapper>